DIM lf as LOGFONTDIM myfont as fontDIM grd AS RAGRIDDIM StatusBar AS STATUSBARDIM FileName AS STRINGDIM SaveFileName AS STRINGDIM FileFilter AS TEXTDIM InitDir AS STRINGDIM TempInt AS LONGDIM TempStr AS STRINGDIM SaveValid AS BOOLEANDIM FindStr AS STRINGDIM ReplaceStr AS STRINGDIM FontStr AS STRINGDIM RGB AS LONGdim tb1 as textboxdim tb2 as textboxdim tb3 as textboxdim tb4 as textboxdim gp as buttondim ap as buttondim gt as buttondim Rpl as buttondim go as buttondim gl as buttondim b as booleandim x as longOBMain.create:SETPOSITION OBMain,0,0,1024,740lf.lfHeight=12lf.lfFaceName="ariel"Create myfont,lfCREATE StatusBar,0,0,0,0CREATE grd,0,32,1015,638grd.font=myfontb=falsegrd.backcolor=$00ffffgrd.forecolor=$0000ffgrd.gridcolor=$00ff00grd.addcol LONG,40,"Hdr1",right,right,31grd.addcol TEXT,100,"Header 2",LEFT,LEFT,31grd.addcol TEXT,100,"Header 3",center,center,31grd.addcol TEXT,100,"Header 4",right,right,31grd.addcol check,100,"Header 5",center,center,31grd.addcol combo,100,"Header 6",center,center,31grd.addcol long,100,"Header 7",right,right,31grd.addcol button,20,"Header 8",right,right,31grd.addcol date,100,"Header 9",right,right,31grd.addcol time,100,"Header 10",right,right,31for TempInt=1 to 100	grd.addrow	grd.value(TempInt,1)=TempInt	grd.value(TempInt,7)=TempInt*100	next TempIntx=grd.value(4,7)grd.value(10,7)=xTempInt=40grd.headerheight=20grd.rowheight=15grd.value(6,5)=1grd.text(6,4)="Poppo"grd.text(5,2)="Test"+" 1"grd.setrowcolor 5,$e0c0c0,$ff0000for TempInt=1 to 100	TempStr="Combo "+str(TempInt)	grd.additem 6,TempStrnext TempIntfor TempInt=1 to 100	;grd.selitem(TempInt,6)=TempIntnext TempInt;grd.text(2,6)="Hello"CREATE tb1,0,5,80,20CREATE tb2,100,5,80,20CREATE tb3,200,5,80,20CREATE tb4,300,5,80,20CREATE gp,400,5,80,20gp.text="getpos"CREATE ap,500,5,80,20ap.text="setpos"CREATE gt,600,5,80,20gt.text="goto line"CREATE Rpl,700,5,80,20Rpl.text="replace"CREATE go,800,5,80,20go.text="goto pos"CREATE gl,900,5,80,20gl.text="getline#"BEGIN MENU OBMain	MENUBAR MainMenu		MENUTITLE FileMenu,"File"			MENUITEM mnuNew,"New"			MENUITEM mnuOpen,"Open"			MENUITEM mnuSave,"Save"			MENUITEM mnuSaveAs,"Save As"			MENUSEPARATOR			MENUITEM mnuPrint,"Print"			MENUSEPARATOR			MENUITEM mnuExit,"Exit"		MENUTITLE EditMenu,"Edit"			MENUITEM mnuUnDo,"Undo"			MENUITEM mnuReDo,"Redo",			MENUSEPARATOR			MENUITEM mnuCut,"Cut"			MENUITEM mnuCopy,"Copy"			MENUITEM mnuPaste,"Paste"			MENUSEPARATOR			MENUITEM mnuSelectAll,"Select All",			MENUSEPARATOR			MENUITEM mnuGotoLine,"Goto Line"			MENUSEPARATOR			MENUITEM mnuFind,"Find"			MENUITEM mnuReplace,"Replace"		MENUTITLE OptionMenu,"Option"			MENUITEM mnuPreferences,"Preferences"			MENUSEPARATOR			MENUITEM mnuBackColor,"Back Color"			MENUITEM mnuForeColor,"Text Color"			MENUITEM mnuGridColor,"Grid Color"			MENUSEPARATOR			MENUITEM mnuFont,"Font"		MENUTITLE CompileMenu,"Compile"			MENUITEM mnuCompile,"Compile To EXE"			MENUITEM mnuCompileAndRun,"Compile And Run"			MENUITEM mnuRun,"Run"			MENUSEPARATOR			MENUITEM mnuTestCompile,"Test Compile"			MENUITEM mnuCompileToAsm,"Compile To Asm"			MENUSEPARATOR			MENUITEM mnuAssemble,"Assemble"		MENUTITLE DebugMenu,"Debug"			MENUITEM mnuStart,"Start"			MENUITEM mnuStop,"Stop"			MENUITEM mnuStep,"Step"			MENUITEM mnuEnd,"End"		MENUTITLE HelpMenu,"Help"			MENUITEM mnuHelp,"Help"			MENUSEPARATOR			MENUITEM mnuAbout,"About"							END MENUENABLEMENUITEM MainMenu,mnuSave,FALSEENABLEMENUITEM MainMenu,mnuSaveAs,FALSESaveFileName=""SaveValid=FALSEInitDir="C:\nb"FileFilter="OB Console",0,"*.obc",0,"OB Window",0,"*.obw",0,"Assembler",0,"*.asm",0,"All Files",0,"*.*",0,0OBMain.TEXT="OmniBasic Grid Demo"FileName="Untitled"grd.text(3,3)="Innomation"END EVENTMENU.commandSELECT CASE MenuID	CASE mnuNew		SaveValid=FALSE		OBMain.TEXT="[OmniBasic IDE     Untitled]"		FileName="Untitled"		ENABLEMENUITEM MainMenu,mnuSave,FALSE		ENABLEMENUITEM MainMenu,mnuSaveAs,FALSE	CASE mnuOpen		FileName=""		OPENDIALOG FileName,FileFilter,InitDir 		IF STATUS<>0 THEN			;Edit.LOADFILE FileName			SaveFileName=FileName			SaveValid=True			EnableMENUITEM MainMenu,mnuSave,TRUE			EnableMENUITEM MainMenu,mnuSaveAs,TRUE			TempStr="OmniBasic IDE     ["+FileName+"]"			OBMain.TEXT=TempStr		END IF	CASE mnuSave		IF FileName="Untitled" THEN			GOSUB SaveAs		END IF		IF SaveValid=TRUE THEN			;Edit.SAVEFILE SaveFileName			ENABLEMENUITEM MainMenu,mnuSave,FALSE		END IF	CASE mnuSaveAs		GOSUB SaveAs	CASE mnuPrint	CASE mnuExit		END	CASE mnuUnDo	CASE mnuReDo	CASE mnuCut	CASE mnuCopy	CASE mnuPaste	CASE mnuSelectAll	CASE mnuGotoLine	CASE mnuFind		FindStr="Find String"		FINDDIALOG FindStr	CASE mnuReplace		FindStr="Find String"		ReplaceStr="Replace String"		REPLACEDIALOG FindStr,ReplaceStr	CASE mnuPreferences	CASE mnuBackColor		COLORDIALOG RGB		TempInt=grd.backcolor		tb1.text=hex(TempInt)		EXIT IF RGB=$ffffffff		grd.backcolor=RGB	CASE mnuForeColor		COLORDIALOG RGB		TempInt=grd.backcolor		tb1.text=hex(TempInt)		EXIT IF RGB=$ffffffff		grd.forecolor=RGB	CASE mnuGridColor		COLORDIALOG RGB		TempInt=grd.backcolor		tb1.text=hex(TempInt)		EXIT IF RGB=$ffffffff		grd.gridcolor=RGB	CASE mnuFont	CASE mnuCompile	CASE mnuCompileAndRun	CASE mnuTestCompile	CASE mnuCompileToAsm	CASE mnuAssemble	CASE mnuStart	CASE mnuStop	CASE mnuStep	CASE mnuEnd	CASE mnuHelp	CASE mnuAboutEND SELECTEND EVENTSaveAs:FileName=""SAVEDIALOG FileName,FileFilter,InitDirIF STATUS<>0 THEN	;Edit.SAVEFILE FileName	SaveFileName=FileName	TempStr="OmniBasic IDE     ["+FileName+"]"	OBMain.TEXT=TempStrEND IFRETURNFIND.notifytb4.text=HEX$(FLAGS)tb3.text=FindStrEND EVENTgp.commandgrd.value(6,5)=0end eventap.commandgrd.value(6,5)=1end eventgt.commandgrd.insertrow 20end eventRpl.commandgrd.deleterow 15end eventgo.commandgrd.moverow 10,12end eventgl.command;TempStr=grd.headertext(3);grd.text(3,3)=TempStr;invoke SendMessage,[!grd],GM_SCROLLCELL,0,0;invoke SendMessage,[!grd],GM_SETCURSEL,1,30;invoke SendMessage,[!grd],GM_RESETCOLUMNS,0,0;invoke SendMessage,[!grd],GM_GETROWCOUNT,0,0;TempInt=grd.rows;tb4.text=str(TempInt);invoke SendMessage,[!grd],GM_ENTEREDIT,1,1grd.enteredit 5,3end eventgrd.headerclicktb1.text="HeaderClick"tb3.text=str(GridCol)grd.sort GridCol,invertingend eventgrd.buttonclickgosub displayrctb1.text="ButtonClick"end eventgrd.checkclickgosub displayrctb1.text="CheckClick"TempInt=grd.value(1,5)TempStr=str(TempInt)OBMain.text=TempStrend eventgrd.beforeselchangegosub displayrctb1.text="beforeselchange";grd.comboclear 6end eventgrd.beforeeditgosub displayrctb1.text="BeforeEdit"end eventgrd.aftereditgosub displayrctb1.text="AfterEdit"end eventgrd.userconvertgosub displayrctb1.text="UserConvert"end eventdisplayrc:tb3.text=str(GridRow)tb4.text=str(GridCol)TempStr=tb1.texttb2.text=TempStrreturn