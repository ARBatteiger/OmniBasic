DIM Frame AS statictextdim rb1(2) as button;statictextdim mousex as longdim mousey as longdim xoffs as longdim yoffs as longdim mousedown as booleanDIM MoveButton AS BUTTONdim NormalButton as buttondim TestButton as frameOBMain.createmousedown=falseCONSTRUCT Frame,10,10,130,140Frame.backcolor=255construct rb1(1),10,10,50,20 in Frameconstruct NormalButton,10,160,80,20NormalButton.text="Normal"construct MoveButton,100,160,80,20MoveButton.text="Move"construct TestButton,200,160,80,20'TestButton.text="Test"end eventMoveButton.commandrb1.interceptonFrame.interceptonTimer1.interval=500end eventNormalButton.commandTestButton.interceptonrb1.interceptoffFrame.interceptoffTimer1.stopOBMain.flashwindow=falseend eventrb1.interceptselect case wmsg	case WM_MOUSEMOVE		if mousedown=true then			getcursorposition			SETPOSITION rb1(1),CursorPosX-mousex-xoffs,CursorPosY-mousey-yoffs,50,20			'SETPOSITION Frame,CursorPosX-mousex-xoffs,CursorPosY-mousey-yoffs,130,140		endif	case WM_LBUTTONDOWN		setcapture rb1(1)		mousedown=true		xoffs=Frame.left				yoffs=Frame.top		'StaticText1.backcolor=$00ff00		gosub getmousepos	case WM_LBUTTONUP		releasecapture		mousedown=false		'StaticText1.backcolor=$ffffff	case else		passintercepteventend selectend eventTestButton.interceptif wmsg=WM_MOUSEMOVE then	Frame.backcolor=$00ff00else	passintercepteventendif	end eventFrame.interceptselect case wmsg	case WM_MOUSEMOVE		if mousedown=true then			getcursorposition			'SETPOSITION rb1,CursorPosX-mousex-xoffs,CursorPosY-mousey-yoffs,50,20			SETPOSITION Frame,CursorPosX-mousex-xoffs,CursorPosY-mousey-yoffs,130,140		endif	case WM_LBUTTONDOWN		setcapture Frame		mousedown=true		xoffs=OBMain.left				yoffs=OBMain.top		'StaticText1.backcolor=$00ff00		gosub getmousepos	case WM_LBUTTONUP		releasecapture		mousedown=false		'StaticText1.backcolor=$ffffff	case else		passintercepteventend selectend eventgetmousepos:mousex=lparammousex=land(mousex,$ffff)mousey=lparammousey=shr(mousey,16)returnTimer1.timerOBMain.flashwindow=trueTimer1.interval=500end event